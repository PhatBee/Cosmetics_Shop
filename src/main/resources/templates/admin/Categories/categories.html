<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.w3.org/1999/xhtml"
      layout:decorate="~{admin/layout-admin.html}">
<section layout:fragment="app-content">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
<main class="content">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">Categories</h1>
        <div class="btn-toolbar mb-2 mb-md-0">
            <div class="btn-group me-2">
                <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
                <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
            </div>
            <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
                <i class="bi bi-calendar"></i> This week
            </button>
        </div>
    </div>

    <!-- Search Form -->
    <form th:action="@{/admin/categories}" method="get" class="d-flex">
        <input type="text" name="search" class="form-control me-2" placeholder="Search by categoryName"
               th:value="${search}" />
        <button type="submit" class="btn btn-outline-primary">Search</button>
    </form>

    <!-- Category Table -->
    <a th:href="@{/admin/categories/add}" class="btn btn-primary mb-3">Add New Category</a>
    <table class="table table-bordered table-striped table-hover">
        <thead>
        <tr>
            <th>#</th>
            <th>Category Name</th>
            <th>Number of products</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody id="categoryTableBody">
        <tr th:each="category : ${categories}">
            <td th:text="${category.categoryId}"></td>
            <td th:text="${category.categoryName}"></td>
            <td th:text="${category.products.size()}"></td>
            <td>
                <span th:if="${category.active}" class="badge bg-success">Active</span>
                <span th:if="${!category.active}" class="badge bg-danger">Inactive</span>
            </td>
            <td>
                <a th:href="@{/admin/categories/edit/{id}(id=${category.categoryId})}" class="btn btn-warning btn-sm">Edit</a>
                <a th:href="@{/admin/categories/delete/{id}(id=${category.categoryId})} "
                   class="btn btn-danger btn-sm"
                   onclick="return confirm('Are you sure you want to delete this category?');">Delete</a>
            </td>
        </tr>
        </tbody>
    </table>

    <!-- Pagination -->
    <ul id="pagination" class="pagination justify-content-center">
        <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
            <a class="page-link" th:href="@{/admin/categories(search=${search}, page=${currentPage - 1})}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
        <li class="page-item" th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
            th:classappend="${currentPage == i} ? 'active'">
            <a class="page-link" th:href="@{/admin/categories(search=${search}, page=${i})}" th:text="${i + 1}"></a>
        </li>
        <li class="page-item" th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
            <a class="page-link" th:href="@{/admin/categories(search=${search}, page=${currentPage + 1})}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
    </ul>
</main>
</section>
