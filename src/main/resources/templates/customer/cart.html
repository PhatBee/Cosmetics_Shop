<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/assets/css/customer/cart.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="/assets/css/all.min.css">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <script src="/assets/js/jquery-3.6.0.min.js"></script><!-- Owl caroucel Js-->

    <!-- Thêm CSRF meta tags -->
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>

    <title>Giỏ Hàng</title>
</head>
<body>
<header th:replace="~{user/fragments/header::header}"></header>

<div class="main py-5">
    <div class="container">
        <h1 class="text-center mb-4">Giỏ Hàng</h1>
        <div class="main__cart bg-light p-4 rounded shadow">
            <div class="row title font-weight-bold text-center mb-3">
                <div class="col-1">Chọn</div> <!-- Column for selecting items -->
                <div class="col-4">Sản phẩm</div>
                <div class="col-2">Giá</div>
                <div class="col-2">Số lượng</div>
                <div class="col-2">Tổng</div>
                <div class="col-1">Hành động</div>
            </div>

            <!-- Iterate over cartItems -->
            <!-- List product active -->
            <div th:each="cartItem : ${cartItems}">
                <div class="row item text-center align-items-center py-2 border-bottom" th:if="${cartItem.product.active}">
                    <div class="col-1">
                        <!-- Checkbox for selection -->
                        <input type="checkbox" class="form-check-input item-checkbox"
                               th:data-cart-item-id="${cartItem.cartItemId}">
                    </div>
                    <div class="col-4 main__cart-product d-flex align-items-center">
                        <!-- Display product image -->
                        <img th:src="@{${cartItem.product.image}}" alt="Product Image" class="img-thumbnail order-image">
                        <a th:class="'name ml-3 ' + (${cartItem.product.active} ? 'product-name-active' : 'product-name-inactive')"
                           th:href="@{/browser/product/{id}(id=${cartItem.product.productId})}" th:text="${cartItem.product.productName}"></a>
                    </div>
                    <div class="col-2 main__cart-price text-primary font-weight-bold"
                         th:text="${#numbers.formatDecimal(cartItem.product.cost, 0, 'COMMA', 2, 'POINT')} + ' ₫'">45,000 ₫
                    </div>
                    <div class="col-2">
                        <input type="number" th:value="${cartItem.quantity}" class="form-control text-center input-qty"
                               min="1" th:data-cart-item-id="${cartItem.cartItemId}">
                    </div>
                    <div class="col-2 main__cart-price text-success font-weight-bold"
                         th:text="${#numbers.formatDecimal(cartItem.product.cost * cartItem.quantity, 0, 'COMMA', 2, 'POINT')} + ' ₫'">45,000 ₫
                    </div>
                    <div class="col-1">
                        <button class="btn btn-danger btn-sm remove remove-item"
                                data-cart-item-id="${cartItem.cartItemId}">Xóa
                        </button>
                    </div>
                </div>
            </div>
            <!-- End iterate -->
            <!-- List product inactive -->
            <br>
            <div class="row title font-weight-bold text-center mb-3 text-danger">
                <div class="col-12">
                    <span class="name ml-3">Danh sách sản phẩm không hoạt động</span>
                </div>
            </div>
            <div th:each="cartItem : ${cartItems}">
                <div class="row item text-center align-items-center py-2 border-bottom" th:if="${!cartItem.product.active}">
                    <div class="col-1">
                        <i class="fas fa-exclamation-triangle text-danger item-checkbox"></i>
                    </div>
                    <div class="col-4 main__cart-product d-flex align-items-center">
                        <img th:src="@{${cartItem.product.image}}" alt="Product Image" class="img-thumbnail order-image">
                        <a style="font-size: 18px; color: red" th:href="@{/browser/product/{id}(id=${cartItem.product.productId})}" class="name ml-3" th:text="${cartItem.product.productName}">Áo sơ mi caro</a>
                    </div>
                    <div class="col-2 main__cart-price text-primary font-weight-bold"
                         th:text="${#numbers.formatDecimal(cartItem.product.cost, 0, 'COMMA', 2, 'POINT')} + ' ₫'">45,000 ₫
                    </div>
                    <div class="col-2">
                        <input type="number" th:value="${cartItem.quantity}" class="form-control text-center input-qty"
                               min="1" th:data-cart-item-id="${cartItem.cartItemId}">
                    </div>
                    <div class="col-2 main__cart-price text-success font-weight-bold"
                         th:text="${#numbers.formatDecimal(cartItem.product.cost * cartItem.quantity, 0, 'COMMA', 2, 'POINT')} + ' ₫'">45,000 ₫
                    </div>
                    <div class="col-1">
                        <button class="btn btn-danger btn-sm remove"
                                th:onclick="'removeItem(' + ${cartItem.cartItemId} + ')'">Xóa
                        </button>
                    </div>
                </div>
            </div>

            <!-- Display total -->
            <div class="total-money text-right font-weight-bold mt-3 text-primary"
                 th:text="'Tổng cộng: ' + ${total} + ' ₫'">Tổng cộng: 45,000 ₫
            </div>

            <!-- Payment button -->
            <div class="text-right mt-3">
                <button type="button" class="btn btn-success btn-lg checkout-btn" >Thanh toán</button>
            </div>
        </div>
    </div>
</div>

<script src="/assets/js/cart.js"></script>
<footer th:replace="~{user/fragments/footer::footer}"></footer>
</body>
</html>